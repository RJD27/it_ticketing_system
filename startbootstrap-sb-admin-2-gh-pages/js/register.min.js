/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2023 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

const bcrypt=require("bcrypt"),mysql=require("mysql"),{AddUserToDatabase,CheckIfEmailInDatabase,GetUserDatabase}=require("./databaseHandler"),ValidateRegister=require("./validator")["ValidateRegister"];async function TryRegisterUser(e,a){var s,{error:e,value:r}=ValidateRegister(e);return e?(console.log(e),!1):((e=GetUserDatabase(mysql)).connect(e=>{if(e)return console.log(e);console.log("DB connection established...")}),await CheckIfEmailInDatabase(e,r.email)?console.log(r.email+" is already in the database."):(s=await bcrypt.hash(r.password,12),console.log("Adding user to database..."),await AddUserToDatabase(e,r.firstName,r.lastName,r.email,s),console.log(r.email+" has been added to the database.")),!0)}exports.TryRegisterUser=TryRegisterUser;